---
{"tags":null,"dg-publish":true,"dg-home":null,"title":"git使用","dg-path":"git使用_{2024-07-17}.md","permalink":"/git使用_{2024-07-17}/","dgPassFrontmatter":true}
---


```table-of-contents
```

# 介绍
## git与github
- **Git** 是一个开源的分布式版本控制系统，它让开发者可以在任何时间点跟踪和控制文件的变更。Git 由 Linus Torvalds 在 2005 年创建，最初的目的是为了更高效地管理 Linux 内核的开发。Git 使得多人在同一项目上工作变得更加简单，因为它允许每个人在自己的分支上开展工作，之后可以将这些分支合并到主项目中。Git 可以在本地运行，不依赖于互联网或者中央服务器。
- **GitHub** 是一个基于网页的托管服务，专为存储和管理使用 Git 版本控制的项目而设计。GitHub 提供了一个图形界面，让用户能够执行各种 Git 命令，同时还加入了一些特有的功能，如问题跟踪、功能请求、任务管理和维基空间。GitHub 使得协作工作变得更加容易，因为它提供了一个中央位置来存储、分享和讨论代码。

总结来说，Git 是一个工具，用于版本控制，而 GitHub 是一个平台，用于托管使用 Git 进行版本控制的项目。GitHub 使得使用 Git 的过程变得更加易于管理和协作，但它不是唯一的选择。还有其他的服务，如 Bitbucket 和 GitLab，也提供了类似的功能。


## 下载配置
[Git 各平台安装包下载地址](https://git-scm.com/downloads)
## Linux 平台上安装
```bash
# 安装 Git 依赖的包
$ sudo apt-get install libcurl4-gnutls-dev libexpat1-dev gettext \
  libz-dev libssl-dev
  
$ sudo apt-get install git

# 测试
$ git --version
git version 1.8.1.2
```

### Git配置
Git 提供了一个叫做 git config 的工具，专门用来配置或读取相应的工作环境变量。
这些环境变量，决定了 Git 在各个环节的具体工作方式和行为。这些变量可以存放在以下三个不同的地方：
- `/etc/gitconfig` 文件：系统中对所有用户都普遍适用的配置。若使用 `git config` 时用 `--system` 选项，读写的就是这个文件。
- `~/.gitconfig` 文件：用户目录下的配置文件只适用于该用户。若使用 `git config` 时用 `--global` 选项，读写的就是这个文件。
- 当前项目的 Git 目录中的配置文件（也就是工作目录中的 `.git/config` 文件）：这里的配置仅仅针对当前项目有效。每一个级别的配置都会覆盖上层的相同配置，所以 `.git/config` 里的配置会覆盖 `/etc/gitconfig` 中的同名变量。

在 Windows 系统上，Git 会找寻用户主目录下的 .gitconfig 文件。主目录即 $HOME 变量指定的目录，一般都是 C:\Documents and Settings\$USER。

此外，Git 还会尝试找寻 /etc/gitconfig 文件，只不过看当初 Git 装在什么目录，就以此作为根目录来定位。

### 用户信息

配置个人的用户名称和电子邮件地址：
```shell
$ git config --global user.name "runoob"
$ git config --global user.email test@runoob.com
```


如果用了 **--global** 选项，那么更改的配置文件就是位于你用户主目录下的那个，以后你所有的项目都会默认使用这里配置的用户信息。

如果要在某个特定的项目中使用其他名字或者电邮，只要去掉 --global 选项重新配置即可，新的设定保存在当前项目的 .git/config 文件里。


### 查看配置信息

要检查已有的配置信息，可以使用 git config --list 命令：

```shell
$ git config --list
http.postbuffer=2M
user.name=runoob
user.email=test@runoob.com
```



有时候会看到重复的变量名，那就说明它们来自不同的配置文件（比如 /etc/gitconfig 和 ~/.gitconfig），不过最终 Git 实际采用的是最后一个。

# Git 工作区、暂存区和版本库
## 基本概念

我们先来理解下 Git 工作区、暂存区和版本库概念：

- **工作区：** 就是你在电脑里能看到的目录。
- **暂存区：** 英文叫 stage 或 index。一般存放在 .git 目录下的 index 文件（.git/index）中，所以我们把暂存区有时也叫作索引（index）。
- **版本库：** 工作区有一个隐藏目录 .git，这个不算工作区，而是 Git 的版本库。

下面这个图展示了工作区、版本库中的暂存区和版本库之间的关系：
![Pasted image 20240315091018.png](/img/user/picture/Pasted%20image%2020240315091018.png)
+ 图中左侧为工作区，右侧为版本库。在版本库中标记为 "index" 的区域是暂存区（stage/index），标记为 "master" 的是 master 分支所代表的目录树。
+ 图中我们可以看出此时 "HEAD" 实际是指向 master 分支的一个"游标"。所以图示的命令中出现 HEAD 的地方可以用 master 来替换。
+ 图中的 objects 标识的区域为 Git 的对象库，实际位于 ".git/objects" 目录下，里面包含了创建的各种对象及内容。
+ 当对工作区修改（或新增）的文件执行 `git add` 命令时，暂存区的目录树被更新，同时工作区修改（或新增）的文件内容被写入到对象库中的一个新的对象中，而该对象的ID被记录在暂存区的文件索引中。
+ 当执行提交操作（git commit）时，暂存区的目录树写到版本库（对象库）中，master 分支会做相应的更新。即 master 指向的目录树就是提交时暂存区的目录树。
+ 当执行` git reset HEAD` 命令时，暂存区的目录树会被重写，被 master 分支指向的目录树所替换，但是工作区不受影响。
+ 当执行 `git rm --cached <file>` 命令时，会直接从暂存区删除文件，工作区则不做出改变。
+ 当执行 `git checkout . `或` git checkout -- <file>` 命令时，会用暂存区全部或指定的文件替换工作区的文件。这个操作很危险，**会清除工作区中未添加到暂存区中的改动。**
+ 当执行 `git checkout HEAD .` 或者 `git checkout HEAD <file>` 命令时，会用 HEAD 指向的 master 分支中的全部或者部分文件替换暂存区和以及工作区中的文件。这个命令也是极具危险性的，因为不但会清除工作区中未提交的改动，也会清除暂存区中未提交的改动。




# Git 创建仓库

## git init

Git 使用 **git init** 命令来初始化一个 Git 仓库，Git 的很多命令都需要在 Git 的仓库中运行，所以 **git init** 是使用 Git 的第一个命令。在执行完成 **git init** 命令后，Git 仓库会生成一个 .git 目录，该目录包含了资源的所有元数据，其他的项目目录保持不变。


如果当前目录下有几个文件想要纳入版本控制，需要先用 git add 命令告诉 Git 开始对这些文件进行跟踪，然后提交：
```shell
$ git add *.c
$ git add README
$ git commit -m '初始化项目版本'
# 注:在 Linux 系统中，commit 信息使用单引号 '，Windows 系统，commit 信息使用双引号 "。
```
以上命令将目录下以 .c 结尾及 README 文件提交到仓库中。

##  git clone

我们使用 **git clone** 从现有 Git 仓库中拷贝项目）。
克隆仓库的命令格式为：
`git clone <repo>`
如果我们需要克隆到指定的目录，可以使用以下命令格式：
`git clone <repo> <directory>`

参数说明：
- **repo:** Git 仓库。
- **directory:** 本地目录。

比如，要克隆 Ruby 语言的 Git 代码仓库 Grit，可以用下面的命令：
```shell
$ git clone git://github.com/schacon/grit.git
```
执行该命令后，会在当前目录下创建一个名为grit的目录，其中包含一个 .git 的目录，用于保存下载下来的所有版本记录。

如果要自己定义要新建的项目目录名称，可以在上面的命令末尾指定新的名字：
```shell
$ git clone git://github.com/schacon/grit.git mygrit
```

## 配置

git 的设置使用 git config 命令。

显示当前的 git 配置信息：

```shell
$ git config --list
credential.helper=osxkeychain
core.repositoryformatversion=0
core.filemode=true
core.bare=false
core.logallrefupdates=true
core.ignorecase=true
core.precomposeunicode=true
```

编辑 git 配置文件:
```shell
$ git config -e    # 针对当前仓库 
或者：
$ git config -e --global   # 针对系统上所有仓库
```

设置提交代码时的用户信息：
```shell
$ git config --global user.name "runoob"
$ git config --global user.email test@runoob.com
```
如果去掉 **--global** 参数只对当前仓库有效。


# Git 基本操作
Git 常用的是以下 6 个命令：**git clone**、**git push**、**git add** 、**git commit**、**git checkout**、**git pull**
![Pasted image 20240315192007.png](/img/user/picture/Pasted%20image%2020240315192007.png)
**说明：**
- workspace：工作区
- staging area：暂存区/缓存区
- local repository：版本库或本地仓库
- remote repository：远程仓库

## 创建仓库
+ [git init  ](https://www.runoob.com/git/git-init.html) 初始化仓库
+ [git clone  ](https://www.runoob.com/git/git-clone.html)  拷贝一份远程仓库，也就是下载一个项目
##  提交与修改

+ [git add](https://www.runoob.com/git/git-add.html) 添加文件到暂存区
+ [git status](https://www.runoob.com/git/git-status.html) 查看仓库当前的状态，显示有变更的文件。
+ [git diff](https://www.runoob.com/git/git-diff.html) 比较文件的不同，即暂存区和工作区的差异。
+ [git commit](https://www.runoob.com/git/git-commit.html) 提交暂存区到本地仓库。
+ [git reset](https://www.runoob.com/git/git-reset.html) 回退版本。
+ [git rm](https://www.runoob.com/git/git-rm.html) 将文件从暂存区和工作区中删除。
+ [git mv](https://www.runoob.com/git/git-mv.html) 移动或重命名工作区文件。
+ [git checkout](https://www.runoob.com/git/git-checkout.html) 分支切换。
+ [git switch](https://www.runoob.com/git/git-switch.html) （Git 2.23 版本引入） 更清晰地切换分支。
+ [git restore](https://www.runoob.com/git/git-restore.html) （Git 2.23 版本引入）恢复或撤销文件的更改。


### 提交日志
+ [git log](https://www.runoob.com/git/git-commit-history.html#git-log) 查看历史提交记录
+ [git blame ](https://www.runoob.com/git/git-commit-history.html#git-blame)  以列表形式查看指定文件的历史修改记录


### 远程操作
+ [git remote](https://www.runoob.com/git/git-remote.html) 远程仓库操作
+ [git fetch](https://www.runoob.com/git/git-fetch.html) 从远程获取代码库
+ [git pull](https://www.runoob.com/git/git-pull.html) 下载远程代码并合并
+ [git push](https://www.runoob.com/git/git-push.html) 上传远程代码并合并


# Git 分支管理
+ 创建分支命令：
	+ `git branch (branchname)`
+ 切换分支命令:
	+ `git checkout (branchname)`
	+ 当你切换分支的时候，Git 会用该分支的最后提交的快照替换你的工作目录的内容， 所以多个分支不需要多个目录。
+ 合并分支命令:
	+ `git merge `
	+ 可以多次合并到统一分支， 也可以选择在合并之后直接删除被并入的分支。
+ 列出分支
	+ `git branch`
+ 删除分支
	+ `git branch -d (branchname)`
+ 




# 使用

## 查看所有分支
```bash
git branch -a
```

## 保存更改但不破坏原本分支
要保存你在 `ch1` 分支上所做的修改，同时又能够回到该分支修改前的状态，你可以使用以下 Git 功能之一：
### 方法 1: 使用 `git stash`

`git stash` 是一个非常实用的命令，允许你临时保存工作目录和暂存区的更改，从而可以回到一个干净的工作状态。之后，你可以在任何时候重新应用这些更改。

1. **保存修改**：
   ```bash
   git stash push -m "描述你的修改"
   ```
   你可以为你的 stash 提供一个消息，以便记住你保存了哪些更改。

2. **返回到 `ch1` 分支的原始状态**：
   这时，你的分支会回到 stash 之前的状态，即修改前的样子。

3. **查看已存储的 stash 列表**：
   ```bash
   git stash list
   ```
   这会显示所有的 stash 项。

4. **重新应用保存的修改**：
   当你准备好将之前保存的修改再次应用到工作目录时，你可以使用：
   ```bash
   git stash pop
   ```
   这将应用最近一次保存的更改并从 stash 列表中移除它。如果你想应用特定的 stash 项并保留在列表中，可以使用 `git stash apply stash@{n}` 命令，其中 `n` 是你想应用的 stash 项的索引。

### 方法 2: 创建一个新分支

如果你认为这些更改以后可能会用到，或者更改比较大，你也可以选择将这些更改保存到一个新的分支上。

1. **创建并切换到新分支**：
   ```bash
   git checkout -b new-branch-name
   ```
   这将创建一个新的分支（基于当前的 `ch1` 分支）并切换到这个分支。这样，你的更改会被保存在这个新分支上。

2. **提交你的更改**：
   ```bash
   git add .
   git commit -m "保存我的更改"
   ```
   这样，你的更改就安全地保存在新分支上了。

3. **返回到 `ch1` 分支的原始状态**：
   当你需要回到 `ch1` 分支并恢复到更改之前的状态时，简单地切换回 `ch1` 分支：
   ```bash
   git checkout ch1
   ```
   这时，`ch1` 分支将是修改之前的状态。

选择哪种方法取决于你的具体需求：如果是临时的、小的更改，使用 `git stash` 可能更方便；如果更改较大或可能长期需要，那么创建一个新分支可能是更好的选择。



## git add .
`git add .` 是一个 Git 命令，用于将当前目录（及其子目录）下的所有新文件和已修改文件添加到暂存区（也称为索引），但不包括被删除的文件。这个命令是在准备提交之前，标记你想要包含在下一个提交快照中的更改。

### 组件解析

- **`git add`**：这是 Git 的基础命令之一，用于添加文件更改到暂存区，使其包含在接下来的提交中。
  
- **`.`**：这个点代表当前目录。在 Git 命令中使用时，它表示将当前工作目录中的所有更改添加到暂存区，包括新文件和修改过的文件，但不包括已删除的文件（删除的文件需要使用 `git rm <file>` 命令来暂存）。

### 使用场景

使用 `git add .` 的典型场景包括：

- **工作目录中有多个文件被修改或新增**，并且你想一次性将所有这些更改添加到暂存区。
- **准备提交**：在执行 `git commit` 提交更改前，使用 `git add .` 确保所有当前目录下的更改都被包括。

### 注意事项

- **选择性添加**：如果你只想暂存部分更改，而不是当前目录下的所有更改，你应该使用 `git add <file>` 或 `git add <directory>` 来指定特定的文件或目录。
- **忽略文件**：对于你不想跟踪的文件（比如临时文件或编译产物），可以在 `.gitignore` 文件中列出这些文件或目录的模式，以防止它们被 `git add .` 添加到暂存区。

`git add .` 是一个非常有用的命令，能够帮助开发者快速地将工作进展暂存起来，但使用时也需要小心，以确保不会不小心包含不应该提交的更改。


## 将远程分支覆盖掉本地分支
要将远程的 `ch1` 分支覆盖掉你本地的 `ch1` 分支，你可以使用以下步骤。这个操作会用远程分支的状态直接替换本地分支的当前状态，因此请确保你不会丢失任何重要的本地更改，或者已经将这些更改备份或推送到另一个分支上。

1. **切换到除 `ch1` 之外的分支**：
   为了安全覆盖本地的 `ch1` 分支，首先确保你当前不在 `ch1` 分支上。你可以切换到另一个分支，如 `main` 或 `master`。
   ```bash
   git checkout main
   ```
   
2. **删除本地的 `ch1` 分支**：
   接下来，删除本地的 `ch1` 分支。因为你要用远程的分支来覆盖它，所以这一步是必要的。
   ```bash
   git branch -D ch1
   ```
   这里使用 `-D` 选项是因为它会强制删除分支，即使它有未合并的更改。

3. **从远程仓库拉取最新信息**：
   为了确保你有最新的远程仓库信息，执行 `git fetch` 命令。这不会改变你的本地文件，只是更新了远程分支的信息。
   ```bash
   git fetch origin
   ```

4. **检出远程的 `ch1` 分支到本地**：
   最后，你可以检出远程的 `ch1` 分支。这会创建一个新的本地分支 `ch1`，它的状态完全匹配远程仓库中的 `ch1` 分支。
   ```bash
   git checkout -b ch1 origin/ch1
   ```
   这个命令会创建并切换到一个新的本地分支 `ch1`，它直接跟踪 `origin/ch1`。

通过上述步骤，你的本地 `ch1` 分支现在应该完全匹配远程仓库中的 `ch1` 分支，包括所有的文件和提交历史。请再次确认你不需要本地 `ch1` 分支上的任何更改，因为这些更改在覆盖过程中会被丢弃。


## 分支重命名
将 `master` 分支重命名为 `main` 是一个简单的过程，可以通过以下几个步骤完成。这里假设你已经在使用名为 `master` 的分支，并且希望将其名称更改为 `main`。

### 本地分支重命名

1. 首先，切换到要重命名的分支（在本例中是 `master`）：

   ```bash
   git checkout master
   ```

2. 使用 `git branch -m` 命令重命名分支。`-m` 参数代表 "move"（即移动或重命名），这将在 Git 中更改分支的名称：

   ```bash
   git branch -m master main
   ```

   此命令将 `master` 分支重命名为 `main`。



## 保存更改
在本地保存你对某个分支的修改，你可以通过提交（commit）操作来实现。提交操作会将你的更改保存到本地仓库的历史记录中，这样你就可以在之后任何时候回溯和查看这些修改。以下是保存修改的基本步骤：

1. **检查当前状态**：
   首先，使用 `git status` 命令查看哪些文件被修改了。
   ```bash
   git status
   ```

2. **暂存更改**：
   根据 `git status` 的输出，你可以决定将哪些文件的更改添加到暂存区（也就是准备提交的更改）。有两种主要的方式来暂存更改：

   - 暂存特定文件：
     ```bash
     git add <filename>
     ```
     将 `<filename>` 替换为你想暂存的文件名。

   - 暂存所有更改：
     ```bash
     git add .
     ```
     这会暂存当前目录下所有已修改的文件（不包括新文件和删除的文件，除非也明确指定）。

3. **提交更改**：
   一旦你暂存了所有想要提交的更改，就可以使用 `git commit` 命令来提交这些更改到你的本地仓库。
   ```bash
   git commit -m "你的提交信息"
   ```
   将 `"你的提交信息"` 替换为一个简明扼要的描述，说明你所做的更改。

4. **查看提交历史**（可选）：
   提交你的更改后，可以使用 `git log` 命令查看提交历史，确认你的提交已经被正确记录。
   ```bash
   git log
   ```
   这将显示一个提交列表，包括提交的作者、日期和提交信息。

通过这些步骤，你就可以在本地保存对某个分支的修改了。如果你想将这些更改推送到远程仓库，可以使用 `git push` 命令。

记得定期提交你的更改，这样可以更好地跟踪和管理项目的进展。